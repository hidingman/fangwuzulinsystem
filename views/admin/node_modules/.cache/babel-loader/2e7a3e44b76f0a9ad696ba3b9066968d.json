{"remainingRequest":"D:\\BYSJ\\一级备份\\JiaoYangSystem\\views\\admin\\node_modules\\thread-loader\\dist\\cjs.js!D:\\BYSJ\\一级备份\\JiaoYangSystem\\views\\admin\\node_modules\\babel-loader\\lib\\index.js!D:\\BYSJ\\一级备份\\JiaoYangSystem\\views\\admin\\src\\mixins\\WebsocketMixin.js","dependencies":[{"path":"D:\\BYSJ\\一级备份\\JiaoYangSystem\\views\\admin\\src\\mixins\\WebsocketMixin.js","mtime":1744648443000},{"path":"D:\\BYSJ\\一级备份\\JiaoYangSystem\\views\\admin\\babel.config.js","mtime":1744648421000},{"path":"D:\\BYSJ\\一级备份\\JiaoYangSystem\\views\\admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\BYSJ\\一级备份\\JiaoYangSystem\\views\\admin\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\BYSJ\\一级备份\\JiaoYangSystem\\views\\admin\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyI7CmltcG9ydCBzdG9yZSBmcm9tICdAL3N0b3JlLyc7Ci8vIGltcG9ydCB7IEFDQ0VTU19UT0tFTiB9IGZyb20gJ0Avc3RvcmUvbXV0YXRpb24tdHlwZXMnCmltcG9ydCBWdWUgZnJvbSAndnVlJzsKaW1wb3J0IGJhc2UgZnJvbSAnQC91dGlscy9iYXNlJzsKaW1wb3J0IHN0b3JhZ2UgZnJvbSAnQC91dGlscy9zdG9yYWdlJzsKZXhwb3J0IHZhciBXZWJzb2NrZXRNaXhpbiA9IHsKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgLy8gdGhpcy5pbml0V2ViU29ja2V0KCk7CiAgfSwKICBkZXN0cm95ZWQ6IGZ1bmN0aW9uIGRlc3Ryb3llZCgpIHsKICAgIC8vIOemu+W8gOmhtemdoueUn+WRveWRqOacn+WHveaVsAogICAgLy8gdGhpcy53ZWJzb2NrZXRPbmNsb3NlKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0V2ViU29ja2V0OiBmdW5jdGlvbiBpbml0V2ViU29ja2V0KHRvSWQpIHsKICAgICAgLy8gbGV0IHRva2VuID0gVnVlLmxzLmdldChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZnJvbnRUb2tlbicpKQogICAgICBjb25zb2xlLmxvZygiLS0tLS0tLS0tLS0tV2ViU29ja2V06L+e5o6l5oiQ5YqfIik7CiAgICAgIC8vIFdlYlNvY2tldOS4juaZrumAmueahOivt+axguaJgOeUqOWNj+iuruacieaJgOS4jeWQjO+8jHdz562J5ZCM5LqOaHR0cO+8jHdzc+etieWQjOS6jmh0dHBzCiAgICAgIHZhciB1c2VySWQgPSBzdG9yYWdlLmdldCgndXNlcmlkJyk7CiAgICAgIC8vIGlmKCF0aGlzLnNvY2tldFVybC5zdGFydHNXaXRoKCcvJykpewogICAgICAvLyAgIHRoaXMuc29ja2V0VXJsID0gJy8nICsgdGhpcy5zb2NrZXRVcmwKICAgICAgLy8gfQogICAgICAvLyBpZighdGhpcy5zb2NrZXRVcmwuZW5kc1dpdGgoJy8nKSl7CiAgICAgIC8vICAgdGhpcy5zb2NrZXRVcmwgPSB0aGlzLnNvY2tldFVybCArICcvJwogICAgICAvLyB9CiAgICAgIHZhciB1cmwgPSAiIi5jb25jYXQoYmFzZS5nZXQoKS51cmwucmVwbGFjZSgvXmh0dHAvLCAid3MiKSwgIndzP3VzZXJfaWQ9IikgKyB1c2VySWQgKyAnJnRvX2lkPScgKyB0b0lkOwogICAgICBpZiAodGhpcy53ZWJzb2NrID09IG51bGwpIHsKICAgICAgICB0aGlzLndlYnNvY2sgPSBuZXcgV2ViU29ja2V0KHVybCk7CiAgICAgICAgdGhpcy53ZWJzb2NrLm9ub3BlbiA9IHRoaXMud2Vic29ja2V0T25vcGVuOwogICAgICAgIHRoaXMud2Vic29jay5vbmVycm9yID0gdGhpcy53ZWJzb2NrZXRPbmVycm9yOwogICAgICAgIHRoaXMud2Vic29jay5vbm1lc3NhZ2UgPSB0aGlzLndlYnNvY2tldE9ubWVzc2FnZTsKICAgICAgICAvLyB0aGlzLndlYnNvY2sub25jbG9zZSA9IHRoaXMud2Vic29ja2V0T25jbG9zZTsKICAgICAgfQogICAgfSwKICAgIHdlYnNvY2tldE9ub3BlbjogZnVuY3Rpb24gd2Vic29ja2V0T25vcGVuKCkgewogICAgICBjb25zb2xlLmxvZygiV2ViU29ja2V06L+e5o6l5oiQ5YqfIik7CiAgICB9LAogICAgd2Vic29ja2V0T25lcnJvcjogZnVuY3Rpb24gd2Vic29ja2V0T25lcnJvcihlKSB7CiAgICAgIGNvbnNvbGUubG9nKCJXZWJTb2NrZXTov57mjqXlj5HnlJ/plJnor68iKTsKICAgICAgdGhpcy5yZWNvbm5lY3QoKTsKICAgIH0sCiAgICB3ZWJzb2NrZXRPbmNsb3NlOiBmdW5jdGlvbiB3ZWJzb2NrZXRPbmNsb3NlKGUpIHsKICAgICAgdGhpcy53ZWJzb2NrLmNsb3NlKDEwMDApOwogICAgICB0aGlzLndlYnNvY2sgPSBudWxsOwogICAgICBjb25zb2xlLmxvZygn5YWz6Zet5LqGJyk7CiAgICAgIC8vIHRoaXMucmVjb25uZWN0KCk7CiAgICB9LAogICAgd2Vic29ja2V0T25tZXNzYWdlOiBmdW5jdGlvbiB3ZWJzb2NrZXRPbm1lc3NhZ2UoZSkgewogICAgICBjb25zb2xlLmxvZygn5pS25Yiw5LqGJywgZSk7CiAgICB9LAogICAgd2Vic29ja2V0U2VuZDogZnVuY3Rpb24gd2Vic29ja2V0U2VuZCh0ZXh0KSB7CiAgICAgIC8vIOaVsOaNruWPkemAgQogICAgICB0cnkgewogICAgICAgIHRoaXMud2Vic29jay5zZW5kKHRleHQpOwogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBjb25zb2xlLmxvZygic2VuZCBmYWlsZWQgKCIgKyBlcnIuY29kZSArICIpIik7CiAgICAgIH0KICAgIH0sCiAgICByZWNvbm5lY3Q6IGZ1bmN0aW9uIHJlY29ubmVjdCgpIHsKICAgICAgLy8gdmFyIHRoYXQgPSB0aGlzOwogICAgICAvLyBpZiAodGhhdC5sb2NrUmVjb25uZWN0KSByZXR1cm47CiAgICAgIC8vIHRoYXQubG9ja1JlY29ubmVjdCA9IHRydWU7CiAgICAgIC8vIC8v5rKh6L+e5o6l5LiK5Lya5LiA55u06YeN6L+e77yM6K6+572u5bu26L+f6YG/5YWN6K+35rGC6L+H5aSaCiAgICAgIC8vIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgIC8vIAljb25zb2xlLmluZm8oIuWwneivlemHjei/ni4uLiIpOwogICAgICAvLyAJdGhhdC5pbml0V2ViU29ja2V0KCk7CiAgICAgIC8vIAl0aGF0LmxvY2tSZWNvbm5lY3QgPSBmYWxzZTsKICAgICAgLy8gfSwgNTAwMCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["store","Vue","base","storage","WebsocketMixin","mounted","destroyed","methods","initWebSocket","toId","console","log","userId","get","url","concat","replace","websock","WebSocket","onopen","websocketOnopen","onerror","websocketOnerror","onmessage","websocketOnmessage","e","reconnect","websocketOnclose","close","websocketSend","text","send","err","code"],"sources":["D:/BYSJ/一级备份/JiaoYangSystem/views/admin/src/mixins/WebsocketMixin.js"],"sourcesContent":["import store from '@/store/'\r\n// import { ACCESS_TOKEN } from '@/store/mutation-types'\r\nimport Vue from 'vue'\r\nimport base from '@/utils/base'\r\nimport storage from '@/utils/storage'\r\nexport const WebsocketMixin = {\r\n\tmounted() {\r\n\t\t// this.initWebSocket();\r\n\t},\r\n\tdestroyed: function() {\r\n\t\t// 离开页面生命周期函数\r\n\t\t// this.websocketOnclose();\r\n\t},\r\n\tmethods: {\r\n\t\tinitWebSocket(toId) {\r\n\t\t\t// let token = Vue.ls.get(localStorage.getItem('frontToken'))\r\n\t\t\tconsole.log(\"------------WebSocket连接成功\");\r\n\t\t\t// WebSocket与普通的请求所用协议有所不同，ws等同于http，wss等同于https\r\n\t\t\tvar userId = storage.get('userid')\r\n\t\t\t// if(!this.socketUrl.startsWith('/')){\r\n\t\t\t//   this.socketUrl = '/' + this.socketUrl\r\n\t\t\t// }\r\n\t\t\t// if(!this.socketUrl.endsWith('/')){\r\n\t\t\t//   this.socketUrl = this.socketUrl + '/'\r\n\t\t\t// }\r\n\t\t\tvar url = `${base.get().url.replace(/^http/, \"ws\")}ws?user_id=` + userId + '&to_id=' + toId;\r\n\t\t\tif (this.websock == null) {\r\n\t\t\t\tthis.websock = new WebSocket(url);\r\n\t\t\t\tthis.websock.onopen = this.websocketOnopen;\r\n\t\t\t\tthis.websock.onerror = this.websocketOnerror;\r\n\t\t\t\tthis.websock.onmessage = this.websocketOnmessage;\r\n\t\t\t\t// this.websock.onclose = this.websocketOnclose;\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\twebsocketOnopen: function() {\r\n\t\t\tconsole.log(\"WebSocket连接成功\");\r\n\t\t},\r\n\t\twebsocketOnerror: function(e) {\r\n\t\t\tconsole.log(\"WebSocket连接发生错误\");\r\n\t\t\tthis.reconnect();\r\n\t\t},\r\n\t\twebsocketOnclose: function(e) {\r\n\t\t\tthis.websock.close(1000)\r\n\t\t\tthis.websock = null\r\n\t\t\tconsole.log('关闭了')\r\n\t\t\t// this.reconnect();\r\n\t\t},\r\n\t\twebsocketOnmessage:function(e) {\r\n\t\t\tconsole.log('收到了',e)\r\n\t\t},\r\n\t\twebsocketSend(text) {\r\n\t\t\t// 数据发送\r\n\t\t\ttry {\r\n\t\t\t\tthis.websock.send(text);\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.log(\"send failed (\" + err.code + \")\");\r\n\t\t\t}\r\n\t\t},\r\n\t\treconnect() {\r\n\t\t\t// var that = this;\r\n\t\t\t// if (that.lockReconnect) return;\r\n\t\t\t// that.lockReconnect = true;\r\n\t\t\t// //没连接上会一直重连，设置延迟避免请求过多\r\n\t\t\t// setTimeout(function() {\r\n\t\t\t// \tconsole.info(\"尝试重连...\");\r\n\t\t\t// \tthat.initWebSocket();\r\n\t\t\t// \tthat.lockReconnect = false;\r\n\t\t\t// }, 5000);\r\n\t\t},\r\n\t}\r\n\r\n}"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,UAAU;AAC5B;AACA,OAAOC,GAAG,MAAM,KAAK;AACrB,OAAOC,IAAI,MAAM,cAAc;AAC/B,OAAOC,OAAO,MAAM,iBAAiB;AACrC,OAAO,IAAMC,cAAc,GAAG;EAC7BC,OAAO,WAAPA,OAAOA,CAAA,EAAG;IACT;EAAA,CACA;EACDC,SAAS,EAAE,SAAXA,SAASA,CAAA,EAAa;IACrB;IACA;EAAA,CACA;EACDC,OAAO,EAAE;IACRC,aAAa,WAAbA,aAAaA,CAACC,IAAI,EAAE;MACnB;MACAC,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC;MACxC;MACA,IAAIC,MAAM,GAAGT,OAAO,CAACU,GAAG,CAAC,QAAQ,CAAC;MAClC;MACA;MACA;MACA;MACA;MACA;MACA,IAAIC,GAAG,GAAG,GAAAC,MAAA,CAAGb,IAAI,CAACW,GAAG,CAAC,CAAC,CAACC,GAAG,CAACE,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,mBAAgBJ,MAAM,GAAG,SAAS,GAAGH,IAAI;MAC3F,IAAI,IAAI,CAACQ,OAAO,IAAI,IAAI,EAAE;QACzB,IAAI,CAACA,OAAO,GAAG,IAAIC,SAAS,CAACJ,GAAG,CAAC;QACjC,IAAI,CAACG,OAAO,CAACE,MAAM,GAAG,IAAI,CAACC,eAAe;QAC1C,IAAI,CAACH,OAAO,CAACI,OAAO,GAAG,IAAI,CAACC,gBAAgB;QAC5C,IAAI,CAACL,OAAO,CAACM,SAAS,GAAG,IAAI,CAACC,kBAAkB;QAChD;MAED;IAED,CAAC;IACDJ,eAAe,EAAE,SAAjBA,eAAeA,CAAA,EAAa;MAC3BV,OAAO,CAACC,GAAG,CAAC,eAAe,CAAC;IAC7B,CAAC;IACDW,gBAAgB,EAAE,SAAlBA,gBAAgBA,CAAWG,CAAC,EAAE;MAC7Bf,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC;MAC9B,IAAI,CAACe,SAAS,CAAC,CAAC;IACjB,CAAC;IACDC,gBAAgB,EAAE,SAAlBA,gBAAgBA,CAAWF,CAAC,EAAE;MAC7B,IAAI,CAACR,OAAO,CAACW,KAAK,CAAC,IAAI,CAAC;MACxB,IAAI,CAACX,OAAO,GAAG,IAAI;MACnBP,OAAO,CAACC,GAAG,CAAC,KAAK,CAAC;MAClB;IACD,CAAC;IACDa,kBAAkB,EAAC,SAAnBA,kBAAkBA,CAAUC,CAAC,EAAE;MAC9Bf,OAAO,CAACC,GAAG,CAAC,KAAK,EAACc,CAAC,CAAC;IACrB,CAAC;IACDI,aAAa,WAAbA,aAAaA,CAACC,IAAI,EAAE;MACnB;MACA,IAAI;QACH,IAAI,CAACb,OAAO,CAACc,IAAI,CAACD,IAAI,CAAC;MACxB,CAAC,CAAC,OAAOE,GAAG,EAAE;QACbtB,OAAO,CAACC,GAAG,CAAC,eAAe,GAAGqB,GAAG,CAACC,IAAI,GAAG,GAAG,CAAC;MAC9C;IACD,CAAC;IACDP,SAAS,WAATA,SAASA,CAAA,EAAG;MACX;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IAAA;EAEF;AAED,CAAC","ignoreList":[]}]}